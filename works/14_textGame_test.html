<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>选字游戏</title>
		<style type="text/css">
			#wrap {
				width: 380px;
				height: 490px;
				box-shadow: 0 0 10px rgba(115, 255, 0, 0.945);
				margin: 0 auto;
			}
			#top {
				width: 100%;
				overflow: hidden;
			}
			#timing {
				float: left;
				margin: 10px;
			}
			#score {
				float: right;
				margin: 10px;
			}
			#bigText {
				text-align: center;
				margin-top: 50px;
				font-size: 160px;
			}
			p {
				text-align: center;
				font-size: 20px;
				padding: 0 15px;
			}
			#smallText {
				text-align: center;
			}
			#smallText span {
				font-size: 60px;
				margin: 0 5px;
			}
		</style>
	</head>
	<body>
		<div id="wrap">
			<div id="top">
				<div id="timing">倒计时：5s</div>
				<div id="score">得分：0</div>
			</div>
			<div id="bigText">蓝</div>
			<p>根据上面的字的颜色从下面选择正确的字，选择正确自动开始</p>
			<div id="smallText">
				<span>粉</span>
				<span>绿</span>
				<span>黄</span>
				<span>蓝</span>
				<span>红</span>
			</div>
		</div>
		<script type="text/javascript">
			//获取元素
			var timeWrap = document.getElementById('timing'); //倒计时容器
			var scoreWrap = document.getElementById('score'); //得分容器
			var bigText = document.getElementById('bigText'); //大字
			var smallTexts = document.querySelectorAll('#smallText span'); //小字
			//声明数据源
			var colorArr = ['blue','red','pink','yellow','green'];
			var textArr = ['蓝','红','粉','黄','绿'];
			//全局变量
			var score = 0;
			var timing = 5; //时间
			var flag = true; //计时器的开关
			//生成随机数
			function rn(max,min) {
				var num = Math.round(Math.random() * (max - min)) + min;
				return num;
			}
			//生成随机的下标数组
			function randomIndexArr() {
				var arr = [];
				while (arr.length < 5){
					var num = rn(0, 4); //随机数
					//是否存在于arr中
					if (arr.indexOf(num) < 0) {
						arr.push(num);
					}
				}
				return arr;
			}
			//生成大字小字
			function createData() {
				var bigTextColorIndex = rn(0 ,4); //颜色下标
				var bigTextIndex = rn(0, 4); //文本下标
				bigText.style.color = colorArr[bigTextColorIndex];
				bigText.innerHTML = textArr[bigTextIndex];
				//创建小字
				var arr = randomIndexArr(); //颜色下标
				var arr2 = randomIndexArr(); //文本下标
				for (var i = 0; i < arr.length; i++) {
					smallTexts[i].style.color = colorArr[arr[i]];
					smallTexts[i].innerHTML = textArr[arr2[i]];
				}
			}
			createData();
			//为所有小字绑定点击事件
			function eleOnclick() {
				//循环小字
				for (var i = 0; i < smallTexts.length; i++) {
					//为每一个小字绑定点击事件
					smallTexts[i].onclick = function () {
						clickOne(this);
					}
				}
			}
			eleOnclick();
			//点击小字
			function clickOne(ele) {
				//获取大字的颜色在colorArr中的位置
				var bigColor = bigText.style.color;
				var bigColorIndex = colorArr.indexOf(bigColor);
				//获取当前点击的字在textArr中的位置
				var smallText = ele.innerHTML;
				var smallTextIndex = textArr.indexOf(smallText);
				//判断两者是否相等
				if (bigColorIndex == smallTextIndex) {
					//重创大字小字
					createData();
					scoreWrap.innerHTML = '得分：' + ++score;
					if (flag) {
						//第一次点击成功时，开始倒计时
						var timer = setInterval( function () {
							//timing累减
							timeWrap.innerHTML = '倒计时：' + --timing + 's';
							//当时间减到0时，时间停止
							if (timing == -1) {
								//停止计时器的调用
								clearInterval(timer);
								alert('您的得分是：' + score + '点击确定重新开始');
								//分数清零
								score = 0;
								scoreWrap.innerHTML = '得分：0';
								//倒计时恢复初值
								timing = 5;
								timeWrap.innerHTML = '倒计时：5s';
								//第一次点击成功开始倒计时
								flag = true;
							}
						},1000);
						//关闭开关
						flag = false;
					}
				}
			}
		</script>
	</body>
</html>
